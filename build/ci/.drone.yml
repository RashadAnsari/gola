---
kind: pipeline
type: docker
name: lint

steps:

  - name: lint
    image: golangci/golangci-lint:v1.40.1
    commands:
      - make lint

---
kind: pipeline
type: docker
name: test

steps:

  - name: test
    image: golang:1.15
    commands:
      - make ci-test

  - name: coverage
    image: plugins/codecov
    when:
      branch:
        - master
      event:
        - tag
    settings:
      token:
        from_secret: codecov_token
      files:
        - coverage.txt

depends_on:
  - lint
